name: 部署测试环境
on:
  push:
    branches:
      - dev
  pull_request:
    branches:
      - master
jobs:
  build:
    runs-on: ubuntu-18.04
    steps:
    - uses: actions/checkout@v2.0.0
    - name: Start Running
      run:
        yarn add
        yarn build
    - uses: actions/setup-python@v1
      with:
        python-version: '3.x'
        architecture: 'x64'
    - name: Install coscmd
      run: pip install -U coscmd

    - name: Upload COS
      env:
        SECRET_ID: ${{ secrets.TENCENTCLOUD_SECRET_ID }}
        SECRET_KEY: ${{ secrets.TENCENTCLOUD_SECRET_KEY }}
        BUCKET: ${{secrets.TENCENTCLOUD_BUCKET}}
        REGION: ap-shanghai
      run:  
        coscmd config -a $SECRET_ID -s $SECRET_KEY -b $BUCKET -r $REGION
        coscmd upload -r / /home/ubuntu/data/
